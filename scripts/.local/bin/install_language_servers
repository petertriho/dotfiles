#!/usr/bin/env bash

set -euo pipefail

function main {
    if ! command -v terraform-ls &> /dev/null; then
        brew install hashicorp/tap/terraform-ls
    fi

    if ! command -v tflint &> /dev/null; then
        brew install tflint
    fi

    if ! command -v rust-analyzer &> /dev/null; then
        brew install rust-analyzer
    fi

    if ! command -v taplo-lsp &> /dev/null; then
        cargo install taplo-lsp
    fi

    if ! command -v taplo-lsp &> /dev/null; then
        cargo install taplo-lsp
    fi

    if ! command -v gopls &> /dev/null; then
        GO111MODULE=on go get golang.org/x/tools/gopls@latest
    fi

    if ! command -v docker-langserver &> /dev/null; then
        yarn global add dockerfile-language-server-nodejs
    fi

    if ! command -v emmet-ls &> /dev/null; then
        yarn global add emmet-ls
    fi

    if ! command -v graphql-lsp &> /dev/null; then
        yarn global add graphql-language-service-cli
    fi

    if ! command -v prisma-language-server &> /dev/null; then
        yarn global add @prisma/language-server
    fi

    if ! command -v pyright-langserver &> /dev/null; then
        yarn global add pyright
    fi

    if ! command -v tailwindcss-language-server &> /dev/null; then
        yarn global add @tailwindcss/language-server
    fi

    if ! command -v typescript-language-server &> /dev/null; then
        yarn global add typescript typescript-language-server
    fi

    if ! command -v vscode-css-language-server &> /dev/null \
        || ! command -v vscode-html-language-server &> /dev/null \
        || ! command -v vscode-json-language-server &> /dev/null \
        || ! command -v vscode-eslint-language-server &> /dev/null; then
        yarn global add vscode-langservers-extracted
    fi

    if ! command -v yaml-language-server &> /dev/null; then
        yarn global add yaml-language-server
    fi

    if ! command -v lua-language-server &> /dev/null; then
        install_lua_language_server
    fi

    asdf reshim
}

main
